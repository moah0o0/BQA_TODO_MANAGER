{% extends "base.html" %}

{% block title %}í™œë™ê°€ - ë¶€ì‚°í€´ì–´í–‰ë™{% endblock %}

{% block content %}
<div class="detail-header">
    <h1 class="detail-title">í™œë™ê°€</h1>
    <p style="color: var(--text-2);">TODO ë‹´ë‹¹ìë¡œ ì§€ì •í•  í™œë™ê°€ ëª©ë¡</p>
</div>

{% if activists %}
<div class="activist-list">
    {% for activist in activists %}
    <div class="activist-item">
        <div class="activist-avatar">{{ activist.name[0] }}</div>
        <div class="activist-info">
            <div class="activist-name">{{ activist.name }}</div>
            <div class="activist-id">ID: {{ activist.id }}</div>
        </div>
        {% if activist.task_count > 0 %}
        <span class="badge category">{{ activist.task_count }}ê±´ ë¯¸ì™„ë£Œ</span>
        {% endif %}
        {% if current_user.id == 1 %}
        <button type="button" class="btn-icon" onclick="openEdit('{{ activist.id }}', '{{ activist.name }}')">âœï¸</button>
        <form action="{{ url_for('activist_delete', activist_id=activist.id) }}" method="post" onsubmit="return confirm('ì‚­ì œ?');">
            <button type="submit" class="btn-icon">ğŸ—‘ï¸</button>
        </form>
        {% endif %}
    </div>
    {% endfor %}
</div>
{% else %}
<div class="empty">
    <p>ë“±ë¡ëœ í™œë™ê°€ê°€ ì—†ìŠµë‹ˆë‹¤</p>
</div>
{% endif %}

{% if current_user.id == 1 %}
<!-- ì¶”ê°€ (ìµœê³  ê´€ë¦¬ìë§Œ) -->
<section class="section" style="margin-top: 24px;">
    <h2 class="section-title">â• ì¶”ê°€</h2>
    <form action="{{ url_for('activist_add') }}" method="post" class="form-card">
        <div class="form-row">
            <div class="form-group">
                <label>ID</label>
                <input type="text" name="id" placeholder="A, B, C..." required maxlength="10" style="text-transform: uppercase;">
            </div>
            <div class="form-group">
                <label>ì´ë¦„</label>
                <input type="text" name="name" placeholder="í™ê¸¸ë™" required>
            </div>
        </div>
        <div class="form-actions">
            <button type="submit" class="btn primary">ì¶”ê°€</button>
        </div>
    </form>
</section>
{% endif %}

{% if current_user.id == 1 %}
<!-- ìˆ˜ì • ëª¨ë‹¬ (ìµœê³  ê´€ë¦¬ìë§Œ) -->
<div id="editModal" class="modal" style="display:none;">
    <div class="modal-bg" onclick="closeEdit()"></div>
    <div class="modal-box">
        <h3>í™œë™ê°€ ìˆ˜ì •</h3>
        <form id="editForm" method="post">
            <div class="form-group">
                <label>ID</label>
                <input type="text" id="editId" name="new_id" required maxlength="10" style="text-transform: uppercase;">
            </div>
            <div class="form-group">
                <label>ì´ë¦„</label>
                <input type="text" id="editName" name="new_name" required>
            </div>
            <div class="modal-actions">
                <button type="button" class="btn secondary" onclick="closeEdit()">ì·¨ì†Œ</button>
                <button type="submit" class="btn primary">ì €ì¥</button>
            </div>
        </form>
    </div>
</div>

<script>
function openEdit(id, name) {
    document.getElementById('editId').value = id;
    document.getElementById('editName').value = name;
    document.getElementById('editForm').action = '/activist/' + id + '/edit';
    document.getElementById('editModal').style.display = 'flex';
}

function closeEdit() {
    document.getElementById('editModal').style.display = 'none';
}

document.addEventListener('keydown', e => {
    if (e.key === 'Escape') closeEdit();
});
</script>
{% endif %}
{% endblock %}
